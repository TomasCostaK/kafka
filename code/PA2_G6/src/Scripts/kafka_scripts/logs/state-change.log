[2021-05-15 18:28:08,823] INFO [Controller id=0 epoch=1] Sending UpdateMetadata request to brokers HashSet(0) for 0 partitions (state.change.logger)
[2021-05-15 18:29:07,042] INFO [Controller id=0 epoch=1] Changed partition Sensors-0 state from NonExistentPartition to NewPartition with assigned replicas 0 (state.change.logger)
[2021-05-15 18:29:07,042] INFO [Controller id=0 epoch=1] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2021-05-15 18:29:07,050] INFO [Controller id=0 epoch=1] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2021-05-15 18:29:07,082] INFO [Controller id=0 epoch=1] Changed partition Sensors-0 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=0, isr=List(0), zkVersion=0) (state.change.logger)
[2021-05-15 18:29:07,085] INFO [Controller id=0 epoch=1] Sending LeaderAndIsr request to broker 0 with 1 become-leader and 0 become-follower partitions (state.change.logger)
[2021-05-15 18:29:07,086] INFO [Controller id=0 epoch=1] Sending UpdateMetadata request to brokers HashSet(0) for 1 partitions (state.change.logger)
[2021-05-15 18:29:07,087] INFO [Controller id=0 epoch=1] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2021-05-15 18:29:07,091] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 1 from controller 0 for 1 partitions (state.change.logger)
[2021-05-15 18:29:07,132] INFO [Broker id=0] Stopped fetchers as part of LeaderAndIsr request correlationId 1 from controller 0 epoch 1 as part of the become-leader transition for 1 partitions (state.change.logger)
[2021-05-15 18:29:07,267] INFO [Broker id=0] Leader Sensors-0 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2021-05-15 18:29:07,320] INFO [Broker id=0] Finished LeaderAndIsr request in 230ms correlationId 1 from controller 0 for 1 partitions (state.change.logger)
[2021-05-15 18:29:07,355] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 1 with correlation id 2 (state.change.logger)
[2021-05-15 18:35:28,690] INFO [Controller id=0 epoch=1] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2021-05-15 18:45:10,838] INFO [Controller id=0 epoch=2] Sending UpdateMetadata request to brokers HashSet(0) for 0 partitions (state.change.logger)
[2021-05-15 18:45:10,895] INFO [Controller id=0 epoch=2] Sending LeaderAndIsr request to broker 0 with 1 become-leader and 0 become-follower partitions (state.change.logger)
[2021-05-15 18:45:10,897] INFO [Controller id=0 epoch=2] Sending UpdateMetadata request to brokers HashSet(0) for 1 partitions (state.change.logger)
[2021-05-15 18:45:11,217] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 1 from controller 0 for 1 partitions (state.change.logger)
[2021-05-15 18:45:11,256] INFO [Broker id=0] Stopped fetchers as part of LeaderAndIsr request correlationId 1 from controller 0 epoch 2 as part of the become-leader transition for 1 partitions (state.change.logger)
[2021-05-15 18:45:11,269] INFO [Broker id=0] Leader Sensors-0 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2021-05-15 18:45:11,286] INFO [Broker id=0] Finished LeaderAndIsr request in 72ms correlationId 1 from controller 0 for 1 partitions (state.change.logger)
[2021-05-15 18:45:11,296] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 2 with correlation id 2 (state.change.logger)
[2021-05-15 18:46:30,262] INFO [Controller id=0 epoch=2] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2021-05-15 18:48:48,429] INFO [Controller id=0 epoch=3] Sending UpdateMetadata request to brokers HashSet(0) for 0 partitions (state.change.logger)
[2021-05-15 18:48:48,478] INFO [Controller id=0 epoch=3] Sending LeaderAndIsr request to broker 0 with 1 become-leader and 0 become-follower partitions (state.change.logger)
[2021-05-15 18:48:48,483] INFO [Controller id=0 epoch=3] Sending UpdateMetadata request to brokers HashSet(0) for 1 partitions (state.change.logger)
[2021-05-15 18:48:48,785] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 1 from controller 0 for 1 partitions (state.change.logger)
[2021-05-15 18:48:48,822] INFO [Broker id=0] Stopped fetchers as part of LeaderAndIsr request correlationId 1 from controller 0 epoch 3 as part of the become-leader transition for 1 partitions (state.change.logger)
[2021-05-15 18:48:48,833] INFO [Broker id=0] Leader Sensors-0 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2021-05-15 18:48:48,859] INFO [Broker id=0] Finished LeaderAndIsr request in 76ms correlationId 1 from controller 0 for 1 partitions (state.change.logger)
[2021-05-15 18:48:48,878] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 3 with correlation id 2 (state.change.logger)
[2021-05-15 18:48:53,848] INFO [Controller id=0 epoch=3] Sending UpdateMetadata request to brokers HashSet(0) for 0 partitions (state.change.logger)
[2021-05-15 18:48:53,851] INFO [Controller id=0 epoch=3] Sending UpdateMetadata request to brokers HashSet(1) for 1 partitions (state.change.logger)
[2021-05-15 18:48:54,537] INFO [Broker id=1] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 3 with correlation id 0 (state.change.logger)
[2021-05-15 18:49:00,191] INFO [Controller id=0 epoch=3] Sending UpdateMetadata request to brokers HashSet(0, 1) for 0 partitions (state.change.logger)
[2021-05-15 18:49:00,199] INFO [Controller id=0 epoch=3] Sending UpdateMetadata request to brokers HashSet(2) for 1 partitions (state.change.logger)
[2021-05-15 18:49:00,777] INFO [Broker id=2] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 3 with correlation id 0 (state.change.logger)
[2021-05-15 18:49:07,868] INFO [Controller id=0 epoch=3] Sending UpdateMetadata request to brokers HashSet(0, 1, 2) for 0 partitions (state.change.logger)
[2021-05-15 18:49:07,877] INFO [Controller id=0 epoch=3] Sending UpdateMetadata request to brokers HashSet(3) for 1 partitions (state.change.logger)
[2021-05-15 18:49:10,002] INFO [Broker id=3] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 3 with correlation id 0 (state.change.logger)
[2021-05-15 18:49:17,040] INFO [Controller id=0 epoch=3] Sending UpdateMetadata request to brokers HashSet(0, 1, 2, 3) for 0 partitions (state.change.logger)
[2021-05-15 18:49:17,050] INFO [Controller id=0 epoch=3] Sending UpdateMetadata request to brokers HashSet(4) for 1 partitions (state.change.logger)
[2021-05-15 18:49:18,711] INFO [Broker id=4] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 3 with correlation id 0 (state.change.logger)
[2021-05-15 18:49:22,406] INFO [Controller id=0 epoch=3] Sending UpdateMetadata request to brokers HashSet(0, 1, 2, 3, 4) for 0 partitions (state.change.logger)
[2021-05-15 18:49:22,444] INFO [Controller id=0 epoch=3] Sending UpdateMetadata request to brokers HashSet(5) for 1 partitions (state.change.logger)
[2021-05-15 18:49:23,045] INFO [Broker id=5] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 3 with correlation id 0 (state.change.logger)
[2021-05-15 18:49:39,567] INFO [Controller id=0 epoch=3] Changed partition Sensor-0 state from NonExistentPartition to NewPartition with assigned replicas 2,1,4 (state.change.logger)
[2021-05-15 18:49:39,567] INFO [Controller id=0 epoch=3] Changed partition Sensor-5 state from NonExistentPartition to NewPartition with assigned replicas 4,5,1 (state.change.logger)
[2021-05-15 18:49:39,573] INFO [Controller id=0 epoch=3] Changed partition Sensor-2 state from NonExistentPartition to NewPartition with assigned replicas 0,2,3 (state.change.logger)
[2021-05-15 18:49:39,574] INFO [Controller id=0 epoch=3] Changed partition Sensor-3 state from NonExistentPartition to NewPartition with assigned replicas 5,3,0 (state.change.logger)
[2021-05-15 18:49:39,575] INFO [Controller id=0 epoch=3] Changed partition Sensor-1 state from NonExistentPartition to NewPartition with assigned replicas 3,4,2 (state.change.logger)
[2021-05-15 18:49:39,575] INFO [Controller id=0 epoch=3] Changed partition Sensor-4 state from NonExistentPartition to NewPartition with assigned replicas 1,0,5 (state.change.logger)
[2021-05-15 18:49:39,576] INFO [Controller id=0 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2021-05-15 18:49:39,594] INFO [Controller id=0 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2021-05-15 18:49:39,953] INFO [Controller id=0 epoch=3] Changed partition Sensor-0 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=0, isr=List(2, 1, 4), zkVersion=0) (state.change.logger)
[2021-05-15 18:49:39,963] INFO [Controller id=0 epoch=3] Changed partition Sensor-5 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=4, leaderEpoch=0, isr=List(4, 5, 1), zkVersion=0) (state.change.logger)
[2021-05-15 18:49:39,964] INFO [Controller id=0 epoch=3] Changed partition Sensor-2 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=0, isr=List(0, 2, 3), zkVersion=0) (state.change.logger)
[2021-05-15 18:49:39,964] INFO [Controller id=0 epoch=3] Changed partition Sensor-3 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=5, leaderEpoch=0, isr=List(5, 3, 0), zkVersion=0) (state.change.logger)
[2021-05-15 18:49:39,965] INFO [Controller id=0 epoch=3] Changed partition Sensor-1 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=3, leaderEpoch=0, isr=List(3, 4, 2), zkVersion=0) (state.change.logger)
[2021-05-15 18:49:39,966] INFO [Controller id=0 epoch=3] Changed partition Sensor-4 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=0, isr=List(1, 0, 5), zkVersion=0) (state.change.logger)
[2021-05-15 18:49:39,967] INFO [Controller id=0 epoch=3] Sending LeaderAndIsr request to broker 0 with 1 become-leader and 2 become-follower partitions (state.change.logger)
[2021-05-15 18:49:39,968] INFO [Controller id=0 epoch=3] Sending LeaderAndIsr request to broker 1 with 1 become-leader and 2 become-follower partitions (state.change.logger)
[2021-05-15 18:49:40,012] INFO [Controller id=0 epoch=3] Sending LeaderAndIsr request to broker 2 with 1 become-leader and 2 become-follower partitions (state.change.logger)
[2021-05-15 18:49:40,014] INFO [Controller id=0 epoch=3] Sending LeaderAndIsr request to broker 3 with 1 become-leader and 2 become-follower partitions (state.change.logger)
[2021-05-15 18:49:40,024] INFO [Controller id=0 epoch=3] Sending LeaderAndIsr request to broker 4 with 1 become-leader and 2 become-follower partitions (state.change.logger)
[2021-05-15 18:49:40,022] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 5 from controller 0 for 3 partitions (state.change.logger)
[2021-05-15 18:49:40,024] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 8 from controller 0 for 3 partitions (state.change.logger)
[2021-05-15 18:49:40,028] INFO [Controller id=0 epoch=3] Sending LeaderAndIsr request to broker 5 with 1 become-leader and 2 become-follower partitions (state.change.logger)
[2021-05-15 18:49:40,044] INFO [Broker id=4] Handling LeaderAndIsr request correlationId 2 from controller 0 for 3 partitions (state.change.logger)
[2021-05-15 18:49:40,068] INFO [Controller id=0 epoch=3] Sending UpdateMetadata request to brokers HashSet(0, 1, 2, 3, 4, 5) for 6 partitions (state.change.logger)
[2021-05-15 18:49:40,076] INFO [Broker id=5] Handling LeaderAndIsr request correlationId 1 from controller 0 for 3 partitions (state.change.logger)
[2021-05-15 18:49:40,089] INFO [Controller id=0 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2021-05-15 18:49:40,174] INFO [Broker id=3] Handling LeaderAndIsr request correlationId 3 from controller 0 for 3 partitions (state.change.logger)
[2021-05-15 18:49:40,234] INFO [Broker id=0] Stopped fetchers as part of LeaderAndIsr request correlationId 8 from controller 0 epoch 3 as part of the become-leader transition for 1 partitions (state.change.logger)
[2021-05-15 18:49:40,268] INFO [Broker id=2] Handling LeaderAndIsr request correlationId 4 from controller 0 for 3 partitions (state.change.logger)
[2021-05-15 18:49:40,472] INFO [Broker id=5] Stopped fetchers as part of LeaderAndIsr request correlationId 1 from controller 0 epoch 3 as part of the become-leader transition for 1 partitions (state.change.logger)
[2021-05-15 18:49:40,542] INFO [Broker id=1] Stopped fetchers as part of LeaderAndIsr request correlationId 5 from controller 0 epoch 3 as part of the become-leader transition for 1 partitions (state.change.logger)
[2021-05-15 18:49:40,568] INFO [Broker id=0] Leader Sensor-2 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0,2,3] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2021-05-15 18:49:40,646] INFO [Broker id=4] Stopped fetchers as part of LeaderAndIsr request correlationId 2 from controller 0 epoch 3 as part of the become-leader transition for 1 partitions (state.change.logger)
[2021-05-15 18:49:40,910] INFO [Broker id=0] Follower Sensor-4 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2021-05-15 18:49:40,929] INFO [Broker id=2] Stopped fetchers as part of LeaderAndIsr request correlationId 4 from controller 0 epoch 3 as part of the become-leader transition for 1 partitions (state.change.logger)
[2021-05-15 18:49:40,981] INFO [Broker id=3] Stopped fetchers as part of LeaderAndIsr request correlationId 3 from controller 0 epoch 3 as part of the become-leader transition for 1 partitions (state.change.logger)
[2021-05-15 18:49:41,158] INFO [Broker id=0] Follower Sensor-3 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2021-05-15 18:49:41,195] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 0 epoch 3 with correlation id 8 for 2 partitions (state.change.logger)
[2021-05-15 18:49:43,899] INFO [Broker id=1] Leader Sensor-4 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1,0,5] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2021-05-15 18:49:43,928] INFO [Broker id=4] Leader Sensor-5 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [4,5,1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2021-05-15 18:49:43,935] INFO [Broker id=2] Leader Sensor-0 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [2,1,4] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2021-05-15 18:49:43,980] INFO [Broker id=5] Leader Sensor-3 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [5,3,0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2021-05-15 18:49:44,072] INFO [Broker id=1] Follower Sensor-5 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2021-05-15 18:49:44,092] INFO [Broker id=1] Follower Sensor-0 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2021-05-15 18:49:44,095] INFO [Broker id=1] Stopped fetchers as part of become-follower request from controller 0 epoch 3 with correlation id 5 for 2 partitions (state.change.logger)
[2021-05-15 18:49:44,221] INFO [Broker id=2] Follower Sensor-2 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2021-05-15 18:49:44,224] INFO [Broker id=5] Follower Sensor-4 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2021-05-15 18:49:44,290] INFO [Broker id=4] Follower Sensor-0 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2021-05-15 18:49:44,332] INFO [Broker id=5] Follower Sensor-5 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2021-05-15 18:49:44,334] INFO [Broker id=5] Stopped fetchers as part of become-follower request from controller 0 epoch 3 with correlation id 1 for 2 partitions (state.change.logger)
[2021-05-15 18:49:44,335] INFO [Broker id=2] Follower Sensor-1 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2021-05-15 18:49:44,337] INFO [Broker id=2] Stopped fetchers as part of become-follower request from controller 0 epoch 3 with correlation id 4 for 2 partitions (state.change.logger)
[2021-05-15 18:49:44,376] INFO [Broker id=4] Follower Sensor-1 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2021-05-15 18:49:44,403] INFO [Broker id=4] Stopped fetchers as part of become-follower request from controller 0 epoch 3 with correlation id 2 for 2 partitions (state.change.logger)
[2021-05-15 18:49:44,459] INFO [Broker id=3] Leader Sensor-1 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [3,4,2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2021-05-15 18:49:44,850] INFO [Broker id=3] Follower Sensor-3 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2021-05-15 18:49:44,881] INFO [Broker id=3] Follower Sensor-2 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2021-05-15 18:49:44,884] INFO [Broker id=3] Stopped fetchers as part of become-follower request from controller 0 epoch 3 with correlation id 3 for 2 partitions (state.change.logger)
[2021-05-15 18:49:45,184] INFO [Broker id=0] Finished LeaderAndIsr request in 5148ms correlationId 8 from controller 0 for 3 partitions (state.change.logger)
[2021-05-15 18:49:45,300] INFO [Broker id=0] Add 6 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 3 with correlation id 9 (state.change.logger)
[2021-05-15 18:49:45,305] INFO [Broker id=1] Finished LeaderAndIsr request in 5286ms correlationId 5 from controller 0 for 3 partitions (state.change.logger)
[2021-05-15 18:49:45,328] INFO [Broker id=1] Add 6 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 3 with correlation id 6 (state.change.logger)
[2021-05-15 18:49:45,424] INFO [Broker id=5] Finished LeaderAndIsr request in 5349ms correlationId 1 from controller 0 for 3 partitions (state.change.logger)
[2021-05-15 18:49:45,459] INFO [Broker id=5] Add 6 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 3 with correlation id 2 (state.change.logger)
[2021-05-15 18:49:45,524] INFO [Broker id=2] Finished LeaderAndIsr request in 5388ms correlationId 4 from controller 0 for 3 partitions (state.change.logger)
[2021-05-15 18:49:45,702] INFO [Broker id=4] Finished LeaderAndIsr request in 5662ms correlationId 2 from controller 0 for 3 partitions (state.change.logger)
[2021-05-15 18:49:45,845] INFO [Broker id=2] Add 6 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 3 with correlation id 5 (state.change.logger)
[2021-05-15 18:49:45,866] INFO [Broker id=4] Add 6 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 3 with correlation id 3 (state.change.logger)
[2021-05-15 18:49:46,294] INFO [Broker id=3] Finished LeaderAndIsr request in 6181ms correlationId 3 from controller 0 for 3 partitions (state.change.logger)
[2021-05-15 18:49:46,461] INFO [Broker id=3] Add 6 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 3 with correlation id 4 (state.change.logger)
[2021-05-15 18:51:05,318] INFO [Controller id=0 epoch=3] Changed partition Sensor-4 from OnlinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=1, isr=List(0, 5), zkVersion=1) (state.change.logger)
[2021-05-15 18:51:05,319] INFO [Controller id=0 epoch=3] Sending LeaderAndIsr request to broker 0 with 1 become-leader and 0 become-follower partitions (state.change.logger)
[2021-05-15 18:51:05,320] INFO [Controller id=0 epoch=3] Sending LeaderAndIsr request to broker 1 with 0 become-leader and 1 become-follower partitions (state.change.logger)
[2021-05-15 18:51:05,321] INFO [Controller id=0 epoch=3] Sending LeaderAndIsr request to broker 5 with 0 become-leader and 1 become-follower partitions (state.change.logger)
[2021-05-15 18:51:05,321] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 10 from controller 0 for 1 partitions (state.change.logger)
[2021-05-15 18:51:05,322] INFO [Controller id=0 epoch=3] Sending UpdateMetadata request to brokers HashSet(0, 1, 2, 3, 4, 5) for 1 partitions (state.change.logger)
[2021-05-15 18:51:05,323] INFO [Broker id=5] Handling LeaderAndIsr request correlationId 3 from controller 0 for 1 partitions (state.change.logger)
[2021-05-15 18:51:05,325] INFO [Broker id=5] Follower Sensor-4 starts at leader epoch 1 from offset 0 with high watermark 0. Previous leader epoch was 0. (state.change.logger)
[2021-05-15 18:51:05,329] INFO [Controller id=0 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2021-05-15 18:51:05,329] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 7 from controller 0 for 1 partitions (state.change.logger)
[2021-05-15 18:51:05,334] INFO [Broker id=1] Follower Sensor-4 starts at leader epoch 1 from offset 0 with high watermark 0. Previous leader epoch was 0. (state.change.logger)
[2021-05-15 18:51:05,336] INFO [Broker id=0] Stopped fetchers as part of LeaderAndIsr request correlationId 10 from controller 0 epoch 3 as part of the become-leader transition for 1 partitions (state.change.logger)
[2021-05-15 18:51:05,338] INFO [Broker id=2] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 3 with correlation id 6 (state.change.logger)
[2021-05-15 18:51:05,339] INFO [Broker id=0] Leader Sensor-4 starts at leader epoch 1 from offset 0 with high watermark 0 ISR [0,5] addingReplicas [] removingReplicas []. Previous leader epoch was 0. (state.change.logger)
[2021-05-15 18:51:05,340] INFO [Broker id=5] Stopped fetchers as part of become-follower request from controller 0 epoch 3 with correlation id 3 for 1 partitions (state.change.logger)
[2021-05-15 18:51:05,336] INFO [Controller id=0 epoch=3] Sending StopReplica request for 2 replicas to broker 1 (state.change.logger)
[2021-05-15 18:51:05,347] INFO [Broker id=1] Stopped fetchers as part of become-follower request from controller 0 epoch 3 with correlation id 7 for 1 partitions (state.change.logger)
[2021-05-15 18:51:05,349] INFO [Broker id=4] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 3 with correlation id 4 (state.change.logger)
[2021-05-15 18:51:05,352] INFO [Broker id=3] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 3 with correlation id 5 (state.change.logger)
[2021-05-15 18:51:05,374] INFO [Controller id=0 epoch=3] Partition Sensor-5 state changed to (Leader:4,ISR:4,5,LeaderEpoch:1,ControllerEpoch:3) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2021-05-15 18:51:05,375] INFO [Broker id=5] Finished LeaderAndIsr request in 52ms correlationId 3 from controller 0 for 1 partitions (state.change.logger)
[2021-05-15 18:51:05,376] INFO [Controller id=0 epoch=3] Partition Sensor-0 state changed to (Leader:2,ISR:2,4,LeaderEpoch:1,ControllerEpoch:3) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2021-05-15 18:51:05,379] INFO [Broker id=5] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 3 with correlation id 4 (state.change.logger)
[2021-05-15 18:51:05,380] INFO [Controller id=0 epoch=3] Sending LeaderAndIsr request to broker 2 with 1 become-leader and 0 become-follower partitions (state.change.logger)
[2021-05-15 18:51:05,381] INFO [Controller id=0 epoch=3] Sending LeaderAndIsr request to broker 4 with 1 become-leader and 1 become-follower partitions (state.change.logger)
[2021-05-15 18:51:05,382] INFO [Controller id=0 epoch=3] Sending LeaderAndIsr request to broker 5 with 0 become-leader and 1 become-follower partitions (state.change.logger)
[2021-05-15 18:51:05,382] INFO [Broker id=2] Handling LeaderAndIsr request correlationId 7 from controller 0 for 1 partitions (state.change.logger)
[2021-05-15 18:51:05,382] INFO [Controller id=0 epoch=3] Sending UpdateMetadata request to brokers HashSet(0, 1, 2, 3, 4, 5) for 2 partitions (state.change.logger)
[2021-05-15 18:51:05,383] INFO [Broker id=4] Handling LeaderAndIsr request correlationId 5 from controller 0 for 2 partitions (state.change.logger)
[2021-05-15 18:51:05,389] INFO [Broker id=5] Handling LeaderAndIsr request correlationId 5 from controller 0 for 1 partitions (state.change.logger)
[2021-05-15 18:51:05,422] INFO [Broker id=5] Follower Sensor-5 starts at leader epoch 1 from offset 0 with high watermark 0. Previous leader epoch was 0. (state.change.logger)
[2021-05-15 18:51:05,424] INFO [Controller id=0 epoch=3] Sending StopReplica request for 2 replicas to broker 1 (state.change.logger)
[2021-05-15 18:51:05,424] INFO [Broker id=5] Stopped fetchers as part of become-follower request from controller 0 epoch 3 with correlation id 5 for 1 partitions (state.change.logger)
[2021-05-15 18:51:05,428] INFO [Broker id=4] Stopped fetchers as part of LeaderAndIsr request correlationId 5 from controller 0 epoch 3 as part of the become-leader transition for 1 partitions (state.change.logger)
[2021-05-15 18:51:05,430] INFO [Broker id=4] Leader Sensor-5 starts at leader epoch 1 from offset 0 with high watermark 0 ISR [4,5] addingReplicas [] removingReplicas []. Previous leader epoch was 0. (state.change.logger)
[2021-05-15 18:51:05,430] INFO [Broker id=2] Stopped fetchers as part of LeaderAndIsr request correlationId 7 from controller 0 epoch 3 as part of the become-leader transition for 1 partitions (state.change.logger)
[2021-05-15 18:51:05,432] INFO [Broker id=2] Leader Sensor-0 starts at leader epoch 1 from offset 0 with high watermark 0 ISR [2,4] addingReplicas [] removingReplicas []. Previous leader epoch was 0. (state.change.logger)
[2021-05-15 18:51:05,440] INFO [Broker id=5] Finished LeaderAndIsr request in 51ms correlationId 5 from controller 0 for 1 partitions (state.change.logger)
[2021-05-15 18:51:05,441] INFO [Broker id=4] Skipped the become-leader state change after marking its partition as leader with correlation id 5 from controller 0 epoch 3 for partition Sensor-5 (last update controller epoch 3) since it is already the leader for the partition. (state.change.logger)
[2021-05-15 18:51:05,443] INFO [Broker id=5] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 3 with correlation id 6 (state.change.logger)
[2021-05-15 18:51:05,444] INFO [Broker id=4] Follower Sensor-0 starts at leader epoch 1 from offset 0 with high watermark 0. Previous leader epoch was 0. (state.change.logger)
[2021-05-15 18:51:05,450] INFO [Broker id=3] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 3 with correlation id 6 (state.change.logger)
[2021-05-15 18:51:05,457] INFO [Broker id=4] Stopped fetchers as part of become-follower request from controller 0 epoch 3 with correlation id 5 for 1 partitions (state.change.logger)
[2021-05-15 18:51:05,462] INFO [Broker id=2] Skipped the become-leader state change after marking its partition as leader with correlation id 7 from controller 0 epoch 3 for partition Sensor-0 (last update controller epoch 3) since it is already the leader for the partition. (state.change.logger)
[2021-05-15 18:51:05,463] INFO [Broker id=2] Finished LeaderAndIsr request in 81ms correlationId 7 from controller 0 for 1 partitions (state.change.logger)
[2021-05-15 18:51:05,466] INFO [Broker id=2] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 3 with correlation id 8 (state.change.logger)
[2021-05-15 18:51:05,474] INFO [Broker id=0] Finished LeaderAndIsr request in 152ms correlationId 10 from controller 0 for 1 partitions (state.change.logger)
[2021-05-15 18:51:05,482] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 3 with correlation id 11 (state.change.logger)
[2021-05-15 18:51:05,483] INFO [Broker id=0] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 3 with correlation id 12 (state.change.logger)
[2021-05-15 18:51:05,498] INFO [Broker id=4] Finished LeaderAndIsr request in 115ms correlationId 5 from controller 0 for 2 partitions (state.change.logger)
[2021-05-15 18:51:05,500] INFO [Broker id=4] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 3 with correlation id 6 (state.change.logger)
[2021-05-15 18:51:05,518] INFO [Broker id=1] Finished LeaderAndIsr request in 189ms correlationId 7 from controller 0 for 1 partitions (state.change.logger)
[2021-05-15 18:51:05,522] INFO [Broker id=1] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 3 with correlation id 8 (state.change.logger)
[2021-05-15 18:51:05,534] INFO [Controller id=0 epoch=3] Changed partition Sensor-0 from OnlinePartition to OnlinePartition with state LeaderAndIsr(leader=4, leaderEpoch=2, isr=List(4), zkVersion=2) (state.change.logger)
[2021-05-15 18:51:05,539] INFO [Controller id=0 epoch=3] Sending LeaderAndIsr request to broker 1 with 0 become-leader and 1 become-follower partitions (state.change.logger)
[2021-05-15 18:51:05,540] INFO [Broker id=1] Handling StopReplica request correlationId 9 from controller 0 for 2 partitions (state.change.logger)
[2021-05-15 18:51:05,540] INFO [Controller id=0 epoch=3] Sending LeaderAndIsr request to broker 2 with 0 become-leader and 1 become-follower partitions (state.change.logger)
[2021-05-15 18:51:05,541] INFO [Controller id=0 epoch=3] Sending LeaderAndIsr request to broker 4 with 1 become-leader and 0 become-follower partitions (state.change.logger)
[2021-05-15 18:51:05,542] INFO [Broker id=2] Handling LeaderAndIsr request correlationId 9 from controller 0 for 1 partitions (state.change.logger)
[2021-05-15 18:51:05,542] INFO [Controller id=0 epoch=3] Sending UpdateMetadata request to brokers HashSet(0, 1, 2, 3, 4, 5) for 1 partitions (state.change.logger)
[2021-05-15 18:51:05,543] INFO [Broker id=2] Follower Sensor-0 starts at leader epoch 2 from offset 0 with high watermark 0. Previous leader epoch was 1. (state.change.logger)
[2021-05-15 18:51:05,544] INFO [Broker id=4] Handling LeaderAndIsr request correlationId 7 from controller 0 for 1 partitions (state.change.logger)
[2021-05-15 18:51:05,545] INFO [Broker id=2] Stopped fetchers as part of become-follower request from controller 0 epoch 3 with correlation id 9 for 1 partitions (state.change.logger)
[2021-05-15 18:51:05,545] INFO [Broker id=1] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 9 epoch 3 for partition Sensor-5 since its associated leader epoch 0 matches the current leader epoch (state.change.logger)
[2021-05-15 18:51:05,546] INFO [Broker id=4] Stopped fetchers as part of LeaderAndIsr request correlationId 7 from controller 0 epoch 3 as part of the become-leader transition for 1 partitions (state.change.logger)
[2021-05-15 18:51:05,546] INFO [Broker id=4] Leader Sensor-0 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [4] addingReplicas [] removingReplicas []. Previous leader epoch was 1. (state.change.logger)
[2021-05-15 18:51:05,547] INFO [Broker id=1] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 9 epoch 3 for partition Sensor-0 since its associated leader epoch 0 matches the current leader epoch (state.change.logger)
[2021-05-15 18:51:05,554] INFO [Broker id=5] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 3 with correlation id 7 (state.change.logger)
[2021-05-15 18:51:05,554] INFO [Controller id=0 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2021-05-15 18:51:05,556] INFO [Broker id=3] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 3 with correlation id 7 (state.change.logger)
[2021-05-15 18:51:05,592] INFO [Broker id=4] Finished LeaderAndIsr request in 48ms correlationId 7 from controller 0 for 1 partitions (state.change.logger)
[2021-05-15 18:51:05,595] INFO [Broker id=4] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 3 with correlation id 8 (state.change.logger)
[2021-05-15 18:51:05,604] INFO [Broker id=1] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 3 with correlation id 10 (state.change.logger)
[2021-05-15 18:51:05,556] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 3 with correlation id 13 (state.change.logger)
[2021-05-15 18:51:05,614] INFO [Broker id=1] Handling StopReplica request correlationId 11 from controller 0 for 2 partitions (state.change.logger)
[2021-05-15 18:51:05,614] INFO [Controller id=0 epoch=3] Sending StopReplica request for 2 replicas to broker 2 (state.change.logger)
[2021-05-15 18:51:05,638] INFO [Broker id=1] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 11 epoch 3 for partition Sensor-5 since its associated leader epoch 0 matches the current leader epoch (state.change.logger)
[2021-05-15 18:51:05,640] INFO [Broker id=1] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 11 epoch 3 for partition Sensor-0 since its associated leader epoch 0 matches the current leader epoch (state.change.logger)
[2021-05-15 18:51:05,641] INFO [Controller id=0 epoch=3] Partition Sensor-2 state changed to (Leader:0,ISR:0,3,LeaderEpoch:1,ControllerEpoch:3) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2021-05-15 18:51:05,641] INFO [Broker id=2] Finished LeaderAndIsr request in 99ms correlationId 9 from controller 0 for 1 partitions (state.change.logger)
[2021-05-15 18:51:05,643] INFO [Controller id=0 epoch=3] Partition Sensor-1 state changed to (Leader:3,ISR:3,4,LeaderEpoch:1,ControllerEpoch:3) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2021-05-15 18:51:05,648] INFO [Controller id=0 epoch=3] Sending LeaderAndIsr request to broker 0 with 1 become-leader and 0 become-follower partitions (state.change.logger)
[2021-05-15 18:51:05,651] INFO [Controller id=0 epoch=3] Sending LeaderAndIsr request to broker 3 with 1 become-leader and 1 become-follower partitions (state.change.logger)
[2021-05-15 18:51:05,653] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 14 from controller 0 for 1 partitions (state.change.logger)
[2021-05-15 18:51:05,653] INFO [Controller id=0 epoch=3] Sending LeaderAndIsr request to broker 4 with 0 become-leader and 1 become-follower partitions (state.change.logger)
[2021-05-15 18:51:05,654] INFO [Broker id=0] Stopped fetchers as part of LeaderAndIsr request correlationId 14 from controller 0 epoch 3 as part of the become-leader transition for 1 partitions (state.change.logger)
[2021-05-15 18:51:05,654] INFO [Broker id=3] Handling LeaderAndIsr request correlationId 8 from controller 0 for 2 partitions (state.change.logger)
[2021-05-15 18:51:05,655] INFO [Broker id=2] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 3 with correlation id 10 (state.change.logger)
[2021-05-15 18:51:05,655] INFO [Broker id=4] Handling LeaderAndIsr request correlationId 9 from controller 0 for 1 partitions (state.change.logger)
[2021-05-15 18:51:05,674] INFO [Broker id=0] Leader Sensor-2 starts at leader epoch 1 from offset 0 with high watermark 0 ISR [0,3] addingReplicas [] removingReplicas []. Previous leader epoch was 0. (state.change.logger)
[2021-05-15 18:51:05,674] INFO [Broker id=4] Follower Sensor-1 starts at leader epoch 1 from offset 0 with high watermark 0. Previous leader epoch was 0. (state.change.logger)
[2021-05-15 18:51:05,654] INFO [Controller id=0 epoch=3] Sending UpdateMetadata request to brokers HashSet(0, 1, 2, 3, 4, 5) for 2 partitions (state.change.logger)
[2021-05-15 18:51:05,677] INFO [Broker id=4] Stopped fetchers as part of become-follower request from controller 0 epoch 3 with correlation id 9 for 1 partitions (state.change.logger)
[2021-05-15 18:51:05,680] INFO [Controller id=0 epoch=3] Sending StopReplica request for 2 replicas to broker 2 (state.change.logger)
[2021-05-15 18:51:05,682] INFO [Broker id=5] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 3 with correlation id 8 (state.change.logger)
[2021-05-15 18:51:05,683] INFO [Broker id=3] Stopped fetchers as part of LeaderAndIsr request correlationId 8 from controller 0 epoch 3 as part of the become-leader transition for 1 partitions (state.change.logger)
[2021-05-15 18:51:05,688] INFO [Broker id=3] Leader Sensor-1 starts at leader epoch 1 from offset 0 with high watermark 0 ISR [3,4] addingReplicas [] removingReplicas []. Previous leader epoch was 0. (state.change.logger)
[2021-05-15 18:51:05,689] INFO [Broker id=0] Skipped the become-leader state change after marking its partition as leader with correlation id 14 from controller 0 epoch 3 for partition Sensor-2 (last update controller epoch 3) since it is already the leader for the partition. (state.change.logger)
[2021-05-15 18:51:05,693] INFO [Broker id=0] Finished LeaderAndIsr request in 41ms correlationId 14 from controller 0 for 1 partitions (state.change.logger)
[2021-05-15 18:51:05,698] INFO [Broker id=2] Handling StopReplica request correlationId 11 from controller 0 for 2 partitions (state.change.logger)
[2021-05-15 18:51:05,699] INFO [Broker id=4] Finished LeaderAndIsr request in 43ms correlationId 9 from controller 0 for 1 partitions (state.change.logger)
[2021-05-15 18:51:05,702] INFO [Broker id=2] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 11 epoch 3 for partition Sensor-2 since its associated leader epoch 0 matches the current leader epoch (state.change.logger)
[2021-05-15 18:51:05,703] INFO [Broker id=0] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 3 with correlation id 15 (state.change.logger)
[2021-05-15 18:51:05,704] INFO [Broker id=4] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 3 with correlation id 10 (state.change.logger)
[2021-05-15 18:51:05,706] INFO [Broker id=2] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 11 epoch 3 for partition Sensor-1 since its associated leader epoch 0 matches the current leader epoch (state.change.logger)
[2021-05-15 18:51:05,708] INFO [Broker id=3] Skipped the become-leader state change after marking its partition as leader with correlation id 8 from controller 0 epoch 3 for partition Sensor-1 (last update controller epoch 3) since it is already the leader for the partition. (state.change.logger)
[2021-05-15 18:51:05,709] INFO [Broker id=3] Follower Sensor-2 starts at leader epoch 1 from offset 0 with high watermark 0. Previous leader epoch was 0. (state.change.logger)
[2021-05-15 18:51:05,715] INFO [Broker id=3] Stopped fetchers as part of become-follower request from controller 0 epoch 3 with correlation id 8 for 1 partitions (state.change.logger)
[2021-05-15 18:51:05,717] INFO [Broker id=2] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 3 with correlation id 12 (state.change.logger)
[2021-05-15 18:51:05,718] INFO [Controller id=0 epoch=3] Changed partition Sensor-3 from OnlinePartition to OnlinePartition with state LeaderAndIsr(leader=3, leaderEpoch=1, isr=List(3, 0), zkVersion=1) (state.change.logger)
[2021-05-15 18:51:05,718] INFO [Controller id=0 epoch=3] Sending LeaderAndIsr request to broker 0 with 0 become-leader and 1 become-follower partitions (state.change.logger)
[2021-05-15 18:51:05,718] INFO [Controller id=0 epoch=3] Sending LeaderAndIsr request to broker 3 with 1 become-leader and 0 become-follower partitions (state.change.logger)
[2021-05-15 18:51:05,719] INFO [Controller id=0 epoch=3] Sending LeaderAndIsr request to broker 5 with 0 become-leader and 1 become-follower partitions (state.change.logger)
[2021-05-15 18:51:05,719] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 16 from controller 0 for 1 partitions (state.change.logger)
[2021-05-15 18:51:05,719] INFO [Broker id=2] Handling StopReplica request correlationId 13 from controller 0 for 2 partitions (state.change.logger)
[2021-05-15 18:51:05,720] INFO [Controller id=0 epoch=3] Sending UpdateMetadata request to brokers HashSet(0, 1, 2, 3, 4, 5) for 1 partitions (state.change.logger)
[2021-05-15 18:51:05,721] INFO [Broker id=5] Handling LeaderAndIsr request correlationId 9 from controller 0 for 1 partitions (state.change.logger)
[2021-05-15 18:51:05,721] INFO [Broker id=5] Follower Sensor-3 starts at leader epoch 1 from offset 0 with high watermark 0. Previous leader epoch was 0. (state.change.logger)
[2021-05-15 18:51:05,722] INFO [Broker id=5] Stopped fetchers as part of become-follower request from controller 0 epoch 3 with correlation id 9 for 1 partitions (state.change.logger)
[2021-05-15 18:51:05,723] INFO [Controller id=0 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2021-05-15 18:51:05,723] INFO [Broker id=2] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 13 epoch 3 for partition Sensor-2 since its associated leader epoch 0 matches the current leader epoch (state.change.logger)
[2021-05-15 18:51:05,720] INFO [Broker id=0] Follower Sensor-3 starts at leader epoch 1 from offset 0 with high watermark 0. Previous leader epoch was 0. (state.change.logger)
[2021-05-15 18:51:05,725] INFO [Broker id=2] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 13 epoch 3 for partition Sensor-1 since its associated leader epoch 0 matches the current leader epoch (state.change.logger)
[2021-05-15 18:51:05,725] INFO [Controller id=0 epoch=3] Sending StopReplica request for 2 replicas to broker 5 (state.change.logger)
[2021-05-15 18:51:05,727] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 0 epoch 3 with correlation id 16 for 1 partitions (state.change.logger)
[2021-05-15 18:51:05,733] INFO [Broker id=4] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 3 with correlation id 11 (state.change.logger)
[2021-05-15 18:51:05,734] INFO [Broker id=2] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 3 with correlation id 14 (state.change.logger)
[2021-05-15 18:51:05,744] INFO [Broker id=0] Finished LeaderAndIsr request in 25ms correlationId 16 from controller 0 for 1 partitions (state.change.logger)
[2021-05-15 18:51:05,746] INFO [Broker id=5] Finished LeaderAndIsr request in 25ms correlationId 9 from controller 0 for 1 partitions (state.change.logger)
[2021-05-15 18:51:05,746] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 3 with correlation id 17 (state.change.logger)
[2021-05-15 18:51:05,751] INFO [Broker id=5] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 3 with correlation id 10 (state.change.logger)
[2021-05-15 18:51:05,754] INFO [Broker id=5] Handling StopReplica request correlationId 11 from controller 0 for 2 partitions (state.change.logger)
[2021-05-15 18:51:05,759] INFO [Broker id=5] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 11 epoch 3 for partition Sensor-4 since its associated leader epoch 1 matches the current leader epoch (state.change.logger)
[2021-05-15 18:51:05,768] INFO [Controller id=0 epoch=3] Partition Sensor-4 state changed to (Leader:0,ISR:0,LeaderEpoch:2,ControllerEpoch:3) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2021-05-15 18:51:05,766] INFO [Broker id=5] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 11 epoch 3 for partition Sensor-5 since its associated leader epoch 1 matches the current leader epoch (state.change.logger)
[2021-05-15 18:51:05,769] INFO [Controller id=0 epoch=3] Partition Sensor-5 state changed to (Leader:4,ISR:4,LeaderEpoch:2,ControllerEpoch:3) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2021-05-15 18:51:05,774] INFO [Controller id=0 epoch=3] Sending LeaderAndIsr request to broker 0 with 1 become-leader and 0 become-follower partitions (state.change.logger)
[2021-05-15 18:51:05,775] INFO [Controller id=0 epoch=3] Sending LeaderAndIsr request to broker 1 with 0 become-leader and 2 become-follower partitions (state.change.logger)
[2021-05-15 18:51:05,776] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 18 from controller 0 for 1 partitions (state.change.logger)
[2021-05-15 18:51:05,776] INFO [Controller id=0 epoch=3] Sending LeaderAndIsr request to broker 4 with 1 become-leader and 0 become-follower partitions (state.change.logger)
[2021-05-15 18:51:05,776] INFO [Controller id=0 epoch=3] Sending UpdateMetadata request to brokers HashSet(0, 1, 2, 3, 4, 5) for 2 partitions (state.change.logger)
[2021-05-15 18:51:05,777] INFO [Broker id=4] Handling LeaderAndIsr request correlationId 12 from controller 0 for 1 partitions (state.change.logger)
[2021-05-15 18:51:05,778] INFO [Broker id=0] Stopped fetchers as part of LeaderAndIsr request correlationId 18 from controller 0 epoch 3 as part of the become-leader transition for 1 partitions (state.change.logger)
[2021-05-15 18:51:05,779] INFO [Broker id=0] Leader Sensor-4 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was 1. (state.change.logger)
[2021-05-15 18:51:05,781] INFO [Broker id=5] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 3 with correlation id 12 (state.change.logger)
[2021-05-15 18:51:05,780] INFO [Controller id=0 epoch=3] Sending StopReplica request for 2 replicas to broker 5 (state.change.logger)
[2021-05-15 18:51:05,788] INFO [Broker id=4] Stopped fetchers as part of LeaderAndIsr request correlationId 12 from controller 0 epoch 3 as part of the become-leader transition for 1 partitions (state.change.logger)
[2021-05-15 18:51:05,790] INFO [Broker id=5] Handling StopReplica request correlationId 13 from controller 0 for 2 partitions (state.change.logger)
[2021-05-15 18:51:05,790] INFO [Broker id=4] Leader Sensor-5 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [4] addingReplicas [] removingReplicas []. Previous leader epoch was 1. (state.change.logger)
[2021-05-15 18:51:05,791] INFO [Broker id=5] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 13 epoch 3 for partition Sensor-4 since its associated leader epoch 1 matches the current leader epoch (state.change.logger)
[2021-05-15 18:51:05,791] INFO [Broker id=5] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 13 epoch 3 for partition Sensor-5 since its associated leader epoch 1 matches the current leader epoch (state.change.logger)
[2021-05-15 18:51:05,796] INFO [Broker id=0] Skipped the become-leader state change after marking its partition as leader with correlation id 18 from controller 0 epoch 3 for partition Sensor-4 (last update controller epoch 3) since it is already the leader for the partition. (state.change.logger)
[2021-05-15 18:51:05,797] INFO [Broker id=0] Finished LeaderAndIsr request in 21ms correlationId 18 from controller 0 for 1 partitions (state.change.logger)
[2021-05-15 18:51:05,799] INFO [Broker id=0] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 3 with correlation id 19 (state.change.logger)
[2021-05-15 18:51:05,799] ERROR [Controller id=0 epoch=3] Controller 0 epoch 3 failed to change state for partition Sensor-5 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-5 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:431)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:553)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:551)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:920)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:428)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:339)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1335)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1297)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1297)
	at kafka.controller.KafkaController.process(KafkaController.scala:2392)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2021-05-15 18:51:05,801] ERROR [Controller id=0 epoch=3] Controller 0 epoch 3 failed to change state for partition Sensor-0 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-0 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:431)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:553)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:551)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:920)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:428)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:339)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1335)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1297)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1297)
	at kafka.controller.KafkaController.process(KafkaController.scala:2392)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2021-05-15 18:51:05,801] INFO [Controller id=0 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2021-05-15 18:51:05,801] INFO [Controller id=0 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2021-05-15 18:51:05,802] INFO [Controller id=0 epoch=3] Sending StopReplica request for 1 replicas to broker 4 (state.change.logger)
[2021-05-15 18:51:05,804] INFO [Broker id=4] Skipped the become-leader state change after marking its partition as leader with correlation id 12 from controller 0 epoch 3 for partition Sensor-5 (last update controller epoch 3) since it is already the leader for the partition. (state.change.logger)
[2021-05-15 18:51:05,805] INFO [Broker id=4] Finished LeaderAndIsr request in 28ms correlationId 12 from controller 0 for 1 partitions (state.change.logger)
[2021-05-15 18:51:05,812] INFO [Broker id=4] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 3 with correlation id 13 (state.change.logger)
[2021-05-15 18:51:05,814] INFO [Controller id=0 epoch=3] Partition Sensor-1 state changed to (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:3) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2021-05-15 18:51:05,815] INFO [Broker id=4] Handling StopReplica request correlationId 14 from controller 0 for 1 partitions (state.change.logger)
[2021-05-15 18:51:05,820] INFO [Broker id=4] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 14 epoch 3 for partition Sensor-1 since its associated leader epoch 1 matches the current leader epoch (state.change.logger)
[2021-05-15 18:51:05,821] INFO [Controller id=0 epoch=3] Sending LeaderAndIsr request to broker 2 with 0 become-leader and 1 become-follower partitions (state.change.logger)
[2021-05-15 18:51:05,821] INFO [Controller id=0 epoch=3] Sending LeaderAndIsr request to broker 3 with 1 become-leader and 0 become-follower partitions (state.change.logger)
[2021-05-15 18:51:05,821] INFO [Controller id=0 epoch=3] Sending UpdateMetadata request to brokers HashSet(0, 1, 2, 3, 4, 5) for 1 partitions (state.change.logger)
[2021-05-15 18:51:05,822] INFO [Controller id=0 epoch=3] Sending StopReplica request for 1 replicas to broker 4 (state.change.logger)
[2021-05-15 18:51:05,823] INFO [Broker id=5] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 3 with correlation id 14 (state.change.logger)
[2021-05-15 18:51:05,824] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 3 with correlation id 20 (state.change.logger)
[2021-05-15 18:51:05,844] ERROR [Controller id=0 epoch=3] Controller 0 epoch 3 failed to change state for partition Sensor-4 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-4 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:431)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:553)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:551)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:920)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:428)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:339)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1335)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1297)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1297)
	at kafka.controller.KafkaController.process(KafkaController.scala:2392)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2021-05-15 18:51:05,846] INFO [Controller id=0 epoch=3] Changed partition Sensor-2 from OnlinePartition to OnlinePartition with state LeaderAndIsr(leader=3, leaderEpoch=2, isr=List(3), zkVersion=2) (state.change.logger)
[2021-05-15 18:51:05,846] INFO [Controller id=0 epoch=3] Sending LeaderAndIsr request to broker 0 with 0 become-leader and 1 become-follower partitions (state.change.logger)
[2021-05-15 18:51:05,847] INFO [Controller id=0 epoch=3] Sending LeaderAndIsr request to broker 2 with 0 become-leader and 1 become-follower partitions (state.change.logger)
[2021-05-15 18:51:05,848] INFO [Controller id=0 epoch=3] Sending LeaderAndIsr request to broker 3 with 1 become-leader and 0 become-follower partitions (state.change.logger)
[2021-05-15 18:51:05,848] INFO [Controller id=0 epoch=3] Sending UpdateMetadata request to brokers HashSet(0, 1, 2, 3, 4, 5) for 1 partitions (state.change.logger)
[2021-05-15 18:51:05,851] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 21 from controller 0 for 1 partitions (state.change.logger)
[2021-05-15 18:51:05,854] INFO [Broker id=0] Follower Sensor-2 starts at leader epoch 2 from offset 0 with high watermark 0. Previous leader epoch was 1. (state.change.logger)
[2021-05-15 18:51:05,856] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 0 epoch 3 with correlation id 21 for 1 partitions (state.change.logger)
[2021-05-15 18:51:05,857] INFO [Controller id=0 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2021-05-15 18:51:05,857] INFO [Broker id=0] Finished LeaderAndIsr request in 6ms correlationId 21 from controller 0 for 1 partitions (state.change.logger)
[2021-05-15 18:51:05,858] INFO [Controller id=0 epoch=3] Sending StopReplica request for 1 replicas to broker 0 (state.change.logger)
[2021-05-15 18:51:05,865] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 3 with correlation id 22 (state.change.logger)
[2021-05-15 18:51:05,870] INFO [Broker id=4] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 3 with correlation id 15 (state.change.logger)
[2021-05-15 18:51:05,872] INFO [Broker id=4] Handling StopReplica request correlationId 16 from controller 0 for 1 partitions (state.change.logger)
[2021-05-15 18:51:05,873] INFO [Broker id=4] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 16 epoch 3 for partition Sensor-1 since its associated leader epoch 1 matches the current leader epoch (state.change.logger)
[2021-05-15 18:51:05,873] INFO [Controller id=0 epoch=3] Partition Sensor-3 state changed to (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:3) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2021-05-15 18:51:05,874] INFO [Controller id=0 epoch=3] Sending LeaderAndIsr request to broker 3 with 1 become-leader and 0 become-follower partitions (state.change.logger)
[2021-05-15 18:51:05,874] INFO [Controller id=0 epoch=3] Sending LeaderAndIsr request to broker 5 with 0 become-leader and 1 become-follower partitions (state.change.logger)
[2021-05-15 18:51:05,875] INFO [Broker id=0] Handling StopReplica request correlationId 23 from controller 0 for 1 partitions (state.change.logger)
[2021-05-15 18:51:05,876] INFO [Broker id=4] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 3 with correlation id 17 (state.change.logger)
[2021-05-15 18:51:05,875] INFO [Controller id=0 epoch=3] Sending UpdateMetadata request to brokers HashSet(0, 1, 2, 3, 4, 5) for 1 partitions (state.change.logger)
[2021-05-15 18:51:05,879] INFO [Controller id=0 epoch=3] Sending StopReplica request for 1 replicas to broker 0 (state.change.logger)
[2021-05-15 18:51:05,881] INFO [Broker id=3] Finished LeaderAndIsr request in 227ms correlationId 8 from controller 0 for 2 partitions (state.change.logger)
[2021-05-15 18:51:05,881] INFO [Broker id=4] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 3 with correlation id 18 (state.change.logger)
[2021-05-15 18:51:05,890] INFO [Broker id=3] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 3 with correlation id 9 (state.change.logger)
[2021-05-15 18:51:05,891] INFO [Broker id=0] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 23 epoch 3 for partition Sensor-3 since its associated leader epoch 1 matches the current leader epoch (state.change.logger)
[2021-05-15 18:51:05,893] INFO [Broker id=3] Handling LeaderAndIsr request correlationId 10 from controller 0 for 1 partitions (state.change.logger)
[2021-05-15 18:51:05,892] ERROR [Controller id=0 epoch=3] Controller 0 epoch 3 failed to change state for partition Sensor-2 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-2 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:431)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:553)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:551)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:920)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:428)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:339)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1335)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1297)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1297)
	at kafka.controller.KafkaController.process(KafkaController.scala:2392)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2021-05-15 18:51:05,895] ERROR [Controller id=0 epoch=3] Controller 0 epoch 3 failed to change state for partition Sensor-3 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-3 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:431)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:553)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:551)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:920)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:428)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:339)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1335)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1297)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1297)
	at kafka.controller.KafkaController.process(KafkaController.scala:2392)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2021-05-15 18:51:05,897] ERROR [Controller id=0 epoch=3] Controller 0 epoch 3 failed to change state for partition Sensor-1 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-1 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:431)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:553)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:551)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:920)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:428)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:339)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1335)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1297)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1297)
	at kafka.controller.KafkaController.process(KafkaController.scala:2392)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2021-05-15 18:51:05,898] INFO [Controller id=0 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2021-05-15 18:51:05,899] INFO [Broker id=3] Stopped fetchers as part of LeaderAndIsr request correlationId 10 from controller 0 epoch 3 as part of the become-leader transition for 1 partitions (state.change.logger)
[2021-05-15 18:51:05,899] INFO [Broker id=3] Leader Sensor-3 starts at leader epoch 1 from offset 0 with high watermark 0 ISR [3,0] addingReplicas [] removingReplicas []. Previous leader epoch was 0. (state.change.logger)
[2021-05-15 18:51:05,899] INFO [Controller id=0 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2021-05-15 18:51:05,906] INFO [Broker id=3] Finished LeaderAndIsr request in 13ms correlationId 10 from controller 0 for 1 partitions (state.change.logger)
[2021-05-15 18:51:05,913] INFO [Broker id=3] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 3 with correlation id 11 (state.change.logger)
[2021-05-15 18:51:05,915] INFO [Broker id=3] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 3 with correlation id 12 (state.change.logger)
[2021-05-15 18:51:05,920] INFO [Broker id=3] Handling LeaderAndIsr request correlationId 13 from controller 0 for 1 partitions (state.change.logger)
[2021-05-15 18:51:05,922] INFO [Broker id=3] Stopped fetchers as part of LeaderAndIsr request correlationId 13 from controller 0 epoch 3 as part of the become-leader transition for 1 partitions (state.change.logger)
[2021-05-15 18:51:05,922] INFO [Broker id=3] Leader Sensor-1 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [3] addingReplicas [] removingReplicas []. Previous leader epoch was 1. (state.change.logger)
[2021-05-15 18:51:05,922] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 3 with correlation id 24 (state.change.logger)
[2021-05-15 18:51:05,926] INFO [Broker id=3] Skipped the become-leader state change after marking its partition as leader with correlation id 13 from controller 0 epoch 3 for partition Sensor-1 (last update controller epoch 3) since it is already the leader for the partition. (state.change.logger)
[2021-05-15 18:51:05,927] INFO [Broker id=3] Finished LeaderAndIsr request in 8ms correlationId 13 from controller 0 for 1 partitions (state.change.logger)
[2021-05-15 18:51:05,929] INFO [Broker id=3] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 3 with correlation id 14 (state.change.logger)
[2021-05-15 18:51:05,930] INFO [Broker id=0] Handling StopReplica request correlationId 25 from controller 0 for 1 partitions (state.change.logger)
[2021-05-15 18:51:05,930] INFO [Broker id=0] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 25 epoch 3 for partition Sensor-3 since its associated leader epoch 1 matches the current leader epoch (state.change.logger)
[2021-05-15 18:51:05,931] INFO [Broker id=3] Handling LeaderAndIsr request correlationId 15 from controller 0 for 1 partitions (state.change.logger)
[2021-05-15 18:51:05,932] INFO [Broker id=3] Stopped fetchers as part of LeaderAndIsr request correlationId 15 from controller 0 epoch 3 as part of the become-leader transition for 1 partitions (state.change.logger)
[2021-05-15 18:51:05,932] INFO [Broker id=3] Leader Sensor-2 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [3] addingReplicas [] removingReplicas []. Previous leader epoch was 1. (state.change.logger)
[2021-05-15 18:51:05,949] INFO [Broker id=3] Finished LeaderAndIsr request in 17ms correlationId 15 from controller 0 for 1 partitions (state.change.logger)
[2021-05-15 18:51:05,952] INFO [Broker id=3] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 3 with correlation id 16 (state.change.logger)
[2021-05-15 18:51:05,953] INFO [Broker id=3] Handling LeaderAndIsr request correlationId 17 from controller 0 for 1 partitions (state.change.logger)
[2021-05-15 18:51:05,954] INFO [Broker id=3] Stopped fetchers as part of LeaderAndIsr request correlationId 17 from controller 0 epoch 3 as part of the become-leader transition for 1 partitions (state.change.logger)
[2021-05-15 18:51:05,954] INFO [Broker id=3] Leader Sensor-3 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [3] addingReplicas [] removingReplicas []. Previous leader epoch was 1. (state.change.logger)
[2021-05-15 18:51:05,957] INFO [Broker id=3] Skipped the become-leader state change after marking its partition as leader with correlation id 17 from controller 0 epoch 3 for partition Sensor-3 (last update controller epoch 3) since it is already the leader for the partition. (state.change.logger)
[2021-05-15 18:51:05,957] INFO [Broker id=3] Finished LeaderAndIsr request in 4ms correlationId 17 from controller 0 for 1 partitions (state.change.logger)
[2021-05-15 18:51:05,959] INFO [Broker id=3] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 3 with correlation id 18 (state.change.logger)
[2021-05-15 18:51:07,034] INFO [Controller id=0 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2021-05-15 18:51:07,084] ERROR [Controller id=0 epoch=3] Controller 0 epoch 3 failed to change state for partition Sensors-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensors-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:431)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:553)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:551)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:920)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:428)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:339)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:618)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:588)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1604)
	at kafka.controller.KafkaController.process(KafkaController.scala:2400)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2021-05-15 18:51:07,085] ERROR [Controller id=0 epoch=3] Controller 0 epoch 3 failed to change state for partition Sensor-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:431)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:553)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:551)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:920)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:428)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:339)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:618)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:588)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1604)
	at kafka.controller.KafkaController.process(KafkaController.scala:2400)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2021-05-15 18:51:07,085] ERROR [Controller id=0 epoch=3] Controller 0 epoch 3 failed to change state for partition Sensor-5 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-5 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:431)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:553)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:551)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:920)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:428)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:339)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:618)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:588)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1604)
	at kafka.controller.KafkaController.process(KafkaController.scala:2400)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2021-05-15 18:51:07,086] ERROR [Controller id=0 epoch=3] Controller 0 epoch 3 failed to change state for partition Sensor-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:431)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:553)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:551)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:920)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:428)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:339)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:618)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:588)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1604)
	at kafka.controller.KafkaController.process(KafkaController.scala:2400)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2021-05-15 18:51:07,086] ERROR [Controller id=0 epoch=3] Controller 0 epoch 3 failed to change state for partition Sensor-3 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-3 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:431)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:553)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:551)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:920)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:428)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:339)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:618)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:588)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1604)
	at kafka.controller.KafkaController.process(KafkaController.scala:2400)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2021-05-15 18:51:07,087] ERROR [Controller id=0 epoch=3] Controller 0 epoch 3 failed to change state for partition Sensor-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:431)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:553)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:551)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:920)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:428)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:339)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:618)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:588)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1604)
	at kafka.controller.KafkaController.process(KafkaController.scala:2400)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2021-05-15 18:51:07,087] ERROR [Controller id=0 epoch=3] Controller 0 epoch 3 failed to change state for partition Sensor-4 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-4 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:431)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:553)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:551)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:920)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:428)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:339)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:618)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:588)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1604)
	at kafka.controller.KafkaController.process(KafkaController.scala:2400)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2021-05-15 18:51:07,095] INFO [Controller id=0 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2021-05-15 18:51:07,113] INFO [Controller id=0 epoch=3] Partition Sensor-4 state changed to (Leader:0,ISR:0,LeaderEpoch:2,ControllerEpoch:3) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2021-05-15 18:51:07,114] INFO [Controller id=0 epoch=3] Partition Sensor-5 state changed to (Leader:4,ISR:4,LeaderEpoch:2,ControllerEpoch:3) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2021-05-15 18:51:07,115] INFO [Controller id=0 epoch=3] Partition Sensor-0 state changed to (Leader:4,ISR:4,LeaderEpoch:2,ControllerEpoch:3) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2021-05-15 18:51:07,119] INFO [Controller id=0 epoch=3] Partition Sensor-2 state changed to (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:3) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2021-05-15 18:51:07,127] INFO [Controller id=0 epoch=3] Partition Sensor-0 state changed to (Leader:4,ISR:4,LeaderEpoch:2,ControllerEpoch:3) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2021-05-15 18:51:07,127] INFO [Controller id=0 epoch=3] Partition Sensor-1 state changed to (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:3) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2021-05-15 18:51:07,130] INFO [Controller id=0 epoch=3] Sending LeaderAndIsr request to broker 0 with 1 become-leader and 1 become-follower partitions (state.change.logger)
[2021-05-15 18:51:07,131] INFO [Controller id=0 epoch=3] Sending LeaderAndIsr request to broker 3 with 2 become-leader and 0 become-follower partitions (state.change.logger)
[2021-05-15 18:51:07,132] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 26 from controller 0 for 2 partitions (state.change.logger)
[2021-05-15 18:51:07,132] INFO [Controller id=0 epoch=3] Sending LeaderAndIsr request to broker 4 with 2 become-leader and 1 become-follower partitions (state.change.logger)
[2021-05-15 18:51:07,133] INFO [Broker id=3] Handling LeaderAndIsr request correlationId 19 from controller 0 for 2 partitions (state.change.logger)
[2021-05-15 18:51:07,134] INFO [Controller id=0 epoch=3] Sending LeaderAndIsr request to broker 5 with 0 become-leader and 2 become-follower partitions (state.change.logger)
[2021-05-15 18:51:07,135] INFO [Broker id=4] Handling LeaderAndIsr request correlationId 19 from controller 0 for 3 partitions (state.change.logger)
[2021-05-15 18:51:07,140] INFO [Broker id=3] Ignoring LeaderAndIsr request from controller 0 with correlation id 19 epoch 3 for partition Sensor-2 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2021-05-15 18:51:07,152] INFO [Broker id=4] Ignoring LeaderAndIsr request from controller 0 with correlation id 19 epoch 3 for partition Sensor-5 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2021-05-15 18:51:07,134] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 26 epoch 3 for partition Sensor-4 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2021-05-15 18:51:07,153] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 26 epoch 3 for partition Sensor-2 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2021-05-15 18:51:07,154] INFO [Broker id=4] Ignoring LeaderAndIsr request from controller 0 with correlation id 19 epoch 3 for partition Sensor-0 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2021-05-15 18:51:07,154] INFO [Broker id=0] Finished LeaderAndIsr request in 22ms correlationId 26 from controller 0 for 2 partitions (state.change.logger)
[2021-05-15 18:51:07,155] INFO [Broker id=4] Follower Sensor-1 starts at leader epoch 2 from offset 0 with high watermark 0. Previous leader epoch was 1. (state.change.logger)
[2021-05-15 18:51:07,157] INFO [Broker id=4] Stopped fetchers as part of become-follower request from controller 0 epoch 3 with correlation id 19 for 1 partitions (state.change.logger)
[2021-05-15 18:51:07,152] INFO [Controller id=0 epoch=3] Sending UpdateMetadata request to brokers HashSet(0, 3, 4, 5) for 5 partitions (state.change.logger)
[2021-05-15 18:51:07,158] INFO [Broker id=4] Finished LeaderAndIsr request in 24ms correlationId 19 from controller 0 for 3 partitions (state.change.logger)
[2021-05-15 18:51:07,152] INFO [Broker id=3] Ignoring LeaderAndIsr request from controller 0 with correlation id 19 epoch 3 for partition Sensor-1 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2021-05-15 18:51:07,163] INFO [Broker id=0] Add 5 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 3 with correlation id 27 (state.change.logger)
[2021-05-15 18:51:07,166] INFO [Broker id=3] Finished LeaderAndIsr request in 33ms correlationId 19 from controller 0 for 2 partitions (state.change.logger)
[2021-05-15 18:51:07,169] INFO [Broker id=3] Add 5 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 3 with correlation id 20 (state.change.logger)
[2021-05-15 18:51:07,171] INFO [Broker id=4] Add 5 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 3 with correlation id 20 (state.change.logger)
[2021-05-15 18:51:07,250] INFO [Controller id=0 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2021-05-15 18:51:07,256] ERROR [Controller id=0 epoch=3] Controller 0 epoch 3 failed to change state for partition Sensors-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensors-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:431)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:553)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:551)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:920)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:428)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:339)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:618)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:588)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1604)
	at kafka.controller.KafkaController.process(KafkaController.scala:2400)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2021-05-15 18:51:07,257] ERROR [Controller id=0 epoch=3] Controller 0 epoch 3 failed to change state for partition Sensor-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:431)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:553)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:551)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:920)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:428)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:339)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:618)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:588)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1604)
	at kafka.controller.KafkaController.process(KafkaController.scala:2400)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2021-05-15 18:51:07,257] ERROR [Controller id=0 epoch=3] Controller 0 epoch 3 failed to change state for partition Sensor-5 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-5 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:431)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:553)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:551)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:920)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:428)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:339)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:618)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:588)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1604)
	at kafka.controller.KafkaController.process(KafkaController.scala:2400)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2021-05-15 18:51:07,258] ERROR [Controller id=0 epoch=3] Controller 0 epoch 3 failed to change state for partition Sensor-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:431)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:553)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:551)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:920)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:428)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:339)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:618)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:588)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1604)
	at kafka.controller.KafkaController.process(KafkaController.scala:2400)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2021-05-15 18:51:07,258] ERROR [Controller id=0 epoch=3] Controller 0 epoch 3 failed to change state for partition Sensor-3 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-3 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:431)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:553)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:551)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:920)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:428)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:339)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:618)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:588)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1604)
	at kafka.controller.KafkaController.process(KafkaController.scala:2400)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2021-05-15 18:51:07,259] ERROR [Controller id=0 epoch=3] Controller 0 epoch 3 failed to change state for partition Sensor-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:431)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:553)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:551)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:920)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:428)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:339)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:618)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:588)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1604)
	at kafka.controller.KafkaController.process(KafkaController.scala:2400)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2021-05-15 18:51:07,259] ERROR [Controller id=0 epoch=3] Controller 0 epoch 3 failed to change state for partition Sensor-4 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-4 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:431)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:553)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:551)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:920)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:428)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:339)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:618)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:588)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1604)
	at kafka.controller.KafkaController.process(KafkaController.scala:2400)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2021-05-15 18:51:07,260] INFO [Controller id=0 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2021-05-15 18:51:07,265] INFO [Controller id=0 epoch=3] Partition Sensor-4 state changed to (Leader:0,ISR:0,LeaderEpoch:2,ControllerEpoch:3) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2021-05-15 18:51:07,278] INFO [Controller id=0 epoch=3] Partition Sensor-5 state changed to (Leader:4,ISR:4,LeaderEpoch:2,ControllerEpoch:3) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2021-05-15 18:51:07,279] INFO [Controller id=0 epoch=3] Partition Sensor-3 state changed to (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:3) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2021-05-15 18:51:07,279] INFO [Controller id=0 epoch=3] Sending LeaderAndIsr request to broker 0 with 1 become-leader and 1 become-follower partitions (state.change.logger)
[2021-05-15 18:51:07,280] INFO [Controller id=0 epoch=3] Sending LeaderAndIsr request to broker 3 with 1 become-leader and 0 become-follower partitions (state.change.logger)
[2021-05-15 18:51:07,280] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 28 from controller 0 for 2 partitions (state.change.logger)
[2021-05-15 18:51:07,292] INFO [Controller id=0 epoch=3] Sending LeaderAndIsr request to broker 4 with 1 become-leader and 0 become-follower partitions (state.change.logger)
[2021-05-15 18:51:07,292] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 28 epoch 3 for partition Sensor-4 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2021-05-15 18:51:07,292] INFO [Broker id=0] Follower Sensor-3 starts at leader epoch 2 from offset 0 with high watermark 0. Previous leader epoch was 1. (state.change.logger)
[2021-05-15 18:51:07,293] INFO [Broker id=3] Handling LeaderAndIsr request correlationId 21 from controller 0 for 1 partitions (state.change.logger)
[2021-05-15 18:51:07,293] INFO [Broker id=4] Handling LeaderAndIsr request correlationId 21 from controller 0 for 1 partitions (state.change.logger)
[2021-05-15 18:51:07,292] INFO [Controller id=0 epoch=3] Sending UpdateMetadata request to brokers HashSet(0, 3, 4) for 3 partitions (state.change.logger)
[2021-05-15 18:51:07,293] INFO [Broker id=3] Ignoring LeaderAndIsr request from controller 0 with correlation id 21 epoch 3 for partition Sensor-3 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2021-05-15 18:51:07,293] INFO [Broker id=4] Ignoring LeaderAndIsr request from controller 0 with correlation id 21 epoch 3 for partition Sensor-5 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2021-05-15 18:51:07,294] INFO [Broker id=3] Finished LeaderAndIsr request in 2ms correlationId 21 from controller 0 for 1 partitions (state.change.logger)
[2021-05-15 18:51:07,294] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 0 epoch 3 with correlation id 28 for 1 partitions (state.change.logger)
[2021-05-15 18:51:07,295] INFO [Broker id=4] Finished LeaderAndIsr request in 2ms correlationId 21 from controller 0 for 1 partitions (state.change.logger)
[2021-05-15 18:51:07,295] INFO [Broker id=0] Finished LeaderAndIsr request in 15ms correlationId 28 from controller 0 for 2 partitions (state.change.logger)
[2021-05-15 18:51:07,298] INFO [Broker id=0] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 3 with correlation id 29 (state.change.logger)
[2021-05-15 18:51:07,298] INFO [Broker id=3] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 3 with correlation id 22 (state.change.logger)
[2021-05-15 18:51:07,298] INFO [Broker id=4] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 3 with correlation id 22 (state.change.logger)
[2021-05-15 18:51:10,868] ERROR [Controller id=0 epoch=3] Controller 0 epoch 3 failed to change state for partition Sensor-5 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-5 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:431)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:553)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:551)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:920)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:428)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:339)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1335)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1297)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1297)
	at kafka.controller.KafkaController.process(KafkaController.scala:2392)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2021-05-15 18:51:10,870] ERROR [Controller id=0 epoch=3] Controller 0 epoch 3 failed to change state for partition Sensor-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-0 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:431)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:553)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:551)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:920)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:428)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:339)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1335)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1297)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1297)
	at kafka.controller.KafkaController.process(KafkaController.scala:2392)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2021-05-15 18:51:10,871] INFO [Controller id=0 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2021-05-15 18:51:10,871] INFO [Controller id=0 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2021-05-15 18:51:10,872] INFO [Controller id=0 epoch=3] Sending StopReplica request for 1 replicas to broker 4 (state.change.logger)
[2021-05-15 18:51:10,873] INFO [Broker id=4] Handling StopReplica request correlationId 23 from controller 0 for 1 partitions (state.change.logger)
[2021-05-15 18:51:10,874] INFO [Broker id=4] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 23 epoch 3 for partition Sensor-1 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2021-05-15 18:51:10,874] INFO [Controller id=0 epoch=3] Partition Sensor-1 state changed to (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:3) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2021-05-15 18:51:10,875] INFO [Controller id=0 epoch=3] Sending LeaderAndIsr request to broker 3 with 1 become-leader and 0 become-follower partitions (state.change.logger)
[2021-05-15 18:51:10,876] INFO [Controller id=0 epoch=3] Sending UpdateMetadata request to brokers HashSet(0, 3, 4) for 1 partitions (state.change.logger)
[2021-05-15 18:51:10,877] INFO [Broker id=3] Handling LeaderAndIsr request correlationId 23 from controller 0 for 1 partitions (state.change.logger)
[2021-05-15 18:51:10,879] INFO [Broker id=3] Ignoring LeaderAndIsr request from controller 0 with correlation id 23 epoch 3 for partition Sensor-1 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2021-05-15 18:51:10,880] INFO [Broker id=3] Finished LeaderAndIsr request in 3ms correlationId 23 from controller 0 for 1 partitions (state.change.logger)
[2021-05-15 18:51:10,890] INFO [Controller id=0 epoch=3] Sending StopReplica request for 1 replicas to broker 4 (state.change.logger)
[2021-05-15 18:51:10,904] INFO [Broker id=4] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 3 with correlation id 24 (state.change.logger)
[2021-05-15 18:51:10,900] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 3 with correlation id 30 (state.change.logger)
[2021-05-15 18:51:10,918] INFO [Broker id=4] Handling StopReplica request correlationId 25 from controller 0 for 1 partitions (state.change.logger)
[2021-05-15 18:51:10,922] INFO [Broker id=3] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 3 with correlation id 24 (state.change.logger)
[2021-05-15 18:51:10,922] INFO [Broker id=4] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 25 epoch 3 for partition Sensor-1 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2021-05-15 18:51:10,937] ERROR [Controller id=0 epoch=3] Controller 0 epoch 3 failed to change state for partition Sensor-4 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-4 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:431)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:553)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:551)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:920)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:428)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:339)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1335)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1297)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1297)
	at kafka.controller.KafkaController.process(KafkaController.scala:2392)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2021-05-15 18:51:10,938] INFO [Controller id=0 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2021-05-15 18:51:10,939] INFO [Controller id=0 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2021-05-15 18:51:10,939] INFO [Controller id=0 epoch=3] Sending StopReplica request for 2 replicas to broker 0 (state.change.logger)
[2021-05-15 18:51:10,940] INFO [Broker id=0] Handling StopReplica request correlationId 31 from controller 0 for 2 partitions (state.change.logger)
[2021-05-15 18:51:10,941] INFO [Broker id=0] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 31 epoch 3 for partition Sensor-2 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2021-05-15 18:51:10,942] INFO [Broker id=0] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 31 epoch 3 for partition Sensor-3 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2021-05-15 18:51:10,942] INFO [Controller id=0 epoch=3] Partition Sensor-2 state changed to (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:3) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2021-05-15 18:51:10,952] INFO [Controller id=0 epoch=3] Partition Sensor-3 state changed to (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:3) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2021-05-15 18:51:10,955] INFO [Controller id=0 epoch=3] Sending LeaderAndIsr request to broker 3 with 2 become-leader and 0 become-follower partitions (state.change.logger)
[2021-05-15 18:51:10,971] INFO [Controller id=0 epoch=3] Sending UpdateMetadata request to brokers HashSet(0, 3, 4) for 2 partitions (state.change.logger)
[2021-05-15 18:51:10,973] INFO [Broker id=3] Handling LeaderAndIsr request correlationId 25 from controller 0 for 2 partitions (state.change.logger)
[2021-05-15 18:51:10,974] INFO [Broker id=3] Ignoring LeaderAndIsr request from controller 0 with correlation id 25 epoch 3 for partition Sensor-2 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2021-05-15 18:51:10,975] INFO [Controller id=0 epoch=3] Sending StopReplica request for 2 replicas to broker 0 (state.change.logger)
[2021-05-15 18:51:10,976] INFO [Broker id=4] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 3 with correlation id 26 (state.change.logger)
[2021-05-15 18:51:10,979] INFO [Broker id=3] Ignoring LeaderAndIsr request from controller 0 with correlation id 25 epoch 3 for partition Sensor-3 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2021-05-15 18:51:10,976] INFO [Broker id=0] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 3 with correlation id 32 (state.change.logger)
[2021-05-15 18:51:10,983] INFO [Broker id=3] Finished LeaderAndIsr request in 11ms correlationId 25 from controller 0 for 2 partitions (state.change.logger)
[2021-05-15 18:51:10,985] INFO [Broker id=0] Handling StopReplica request correlationId 33 from controller 0 for 2 partitions (state.change.logger)
[2021-05-15 18:51:10,986] INFO [Broker id=0] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 33 epoch 3 for partition Sensor-2 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2021-05-15 18:51:10,992] INFO [Broker id=0] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 33 epoch 3 for partition Sensor-3 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2021-05-15 18:51:11,000] INFO [Broker id=3] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 3 with correlation id 26 (state.change.logger)
[2021-05-15 18:51:10,992] ERROR [Controller id=0 epoch=3] Controller 0 epoch 3 failed to change state for partition Sensor-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-2 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:431)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:553)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:551)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:920)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:428)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:339)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1335)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1297)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1297)
	at kafka.controller.KafkaController.process(KafkaController.scala:2392)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2021-05-15 18:51:11,006] ERROR [Controller id=0 epoch=3] Controller 0 epoch 3 failed to change state for partition Sensor-3 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-3 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:431)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:553)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:551)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:920)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:428)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:339)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1335)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1297)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1297)
	at kafka.controller.KafkaController.process(KafkaController.scala:2392)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2021-05-15 18:51:11,025] ERROR [Controller id=0 epoch=3] Controller 0 epoch 3 failed to change state for partition Sensor-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-1 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:431)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:553)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:551)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:920)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:428)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:339)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1335)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1297)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1297)
	at kafka.controller.KafkaController.process(KafkaController.scala:2392)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2021-05-15 18:51:11,033] INFO [Controller id=0 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2021-05-15 18:51:11,033] INFO [Controller id=0 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2021-05-15 18:51:15,947] ERROR [Controller id=0 epoch=3] Controller 0 epoch 3 failed to change state for partition Sensor-5 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-5 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:431)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:553)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:551)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:920)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:428)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:339)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1335)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1297)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1297)
	at kafka.controller.KafkaController.process(KafkaController.scala:2392)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2021-05-15 18:51:15,948] ERROR [Controller id=0 epoch=3] Controller 0 epoch 3 failed to change state for partition Sensor-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-0 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:431)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:553)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:551)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:920)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:428)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:339)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1335)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1297)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1297)
	at kafka.controller.KafkaController.process(KafkaController.scala:2392)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2021-05-15 18:51:15,949] INFO [Controller id=0 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2021-05-15 18:51:15,950] INFO [Controller id=0 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2021-05-15 18:51:15,950] INFO [Controller id=0 epoch=3] Sending StopReplica request for 1 replicas to broker 4 (state.change.logger)
[2021-05-15 18:51:15,952] INFO [Broker id=4] Handling StopReplica request correlationId 27 from controller 0 for 1 partitions (state.change.logger)
[2021-05-15 18:51:15,953] INFO [Broker id=4] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 27 epoch 3 for partition Sensor-1 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2021-05-15 18:51:15,954] INFO [Controller id=0 epoch=3] Partition Sensor-1 state changed to (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:3) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2021-05-15 18:51:15,955] INFO [Controller id=0 epoch=3] Sending LeaderAndIsr request to broker 3 with 1 become-leader and 0 become-follower partitions (state.change.logger)
[2021-05-15 18:51:15,956] INFO [Controller id=0 epoch=3] Sending UpdateMetadata request to brokers HashSet(0, 3, 4) for 1 partitions (state.change.logger)
[2021-05-15 18:51:15,957] INFO [Controller id=0 epoch=3] Sending StopReplica request for 1 replicas to broker 4 (state.change.logger)
[2021-05-15 18:51:15,957] INFO [Broker id=3] Handling LeaderAndIsr request correlationId 27 from controller 0 for 1 partitions (state.change.logger)
[2021-05-15 18:51:15,958] INFO [Broker id=3] Ignoring LeaderAndIsr request from controller 0 with correlation id 27 epoch 3 for partition Sensor-1 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2021-05-15 18:51:15,957] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 3 with correlation id 34 (state.change.logger)
[2021-05-15 18:51:15,959] INFO [Broker id=4] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 3 with correlation id 28 (state.change.logger)
[2021-05-15 18:51:15,960] INFO [Broker id=3] Finished LeaderAndIsr request in 3ms correlationId 27 from controller 0 for 1 partitions (state.change.logger)
[2021-05-15 18:51:15,962] INFO [Broker id=4] Handling StopReplica request correlationId 29 from controller 0 for 1 partitions (state.change.logger)
[2021-05-15 18:51:15,963] INFO [Broker id=4] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 29 epoch 3 for partition Sensor-1 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2021-05-15 18:51:15,966] INFO [Broker id=3] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 3 with correlation id 28 (state.change.logger)
[2021-05-15 18:51:16,004] ERROR [Controller id=0 epoch=3] Controller 0 epoch 3 failed to change state for partition Sensor-4 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-4 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:431)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:553)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:551)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:920)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:428)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:339)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1335)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1297)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1297)
	at kafka.controller.KafkaController.process(KafkaController.scala:2392)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2021-05-15 18:51:16,005] INFO [Controller id=0 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2021-05-15 18:51:16,006] INFO [Controller id=0 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2021-05-15 18:51:16,006] INFO [Controller id=0 epoch=3] Sending StopReplica request for 2 replicas to broker 0 (state.change.logger)
[2021-05-15 18:51:16,007] INFO [Broker id=0] Handling StopReplica request correlationId 35 from controller 0 for 2 partitions (state.change.logger)
[2021-05-15 18:51:16,008] INFO [Broker id=0] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 35 epoch 3 for partition Sensor-2 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2021-05-15 18:51:16,008] INFO [Broker id=0] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 35 epoch 3 for partition Sensor-3 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2021-05-15 18:51:16,008] INFO [Controller id=0 epoch=3] Partition Sensor-2 state changed to (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:3) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2021-05-15 18:51:16,009] INFO [Controller id=0 epoch=3] Partition Sensor-3 state changed to (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:3) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2021-05-15 18:51:16,010] INFO [Controller id=0 epoch=3] Sending LeaderAndIsr request to broker 3 with 2 become-leader and 0 become-follower partitions (state.change.logger)
[2021-05-15 18:51:16,011] INFO [Controller id=0 epoch=3] Sending UpdateMetadata request to brokers HashSet(0, 3, 4) for 2 partitions (state.change.logger)
[2021-05-15 18:51:16,012] INFO [Controller id=0 epoch=3] Sending StopReplica request for 2 replicas to broker 0 (state.change.logger)
[2021-05-15 18:51:16,012] INFO [Broker id=3] Handling LeaderAndIsr request correlationId 29 from controller 0 for 2 partitions (state.change.logger)
[2021-05-15 18:51:16,015] INFO [Broker id=3] Ignoring LeaderAndIsr request from controller 0 with correlation id 29 epoch 3 for partition Sensor-2 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2021-05-15 18:51:16,015] INFO [Broker id=4] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 3 with correlation id 30 (state.change.logger)
[2021-05-15 18:51:16,013] INFO [Broker id=0] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 3 with correlation id 36 (state.change.logger)
[2021-05-15 18:51:16,016] INFO [Broker id=3] Ignoring LeaderAndIsr request from controller 0 with correlation id 29 epoch 3 for partition Sensor-3 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2021-05-15 18:51:16,017] INFO [Broker id=0] Handling StopReplica request correlationId 37 from controller 0 for 2 partitions (state.change.logger)
[2021-05-15 18:51:16,018] INFO [Broker id=0] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 37 epoch 3 for partition Sensor-2 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2021-05-15 18:51:16,018] INFO [Broker id=0] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 37 epoch 3 for partition Sensor-3 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2021-05-15 18:51:16,019] INFO [Broker id=3] Finished LeaderAndIsr request in 7ms correlationId 29 from controller 0 for 2 partitions (state.change.logger)
[2021-05-15 18:51:16,022] INFO [Broker id=3] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 3 with correlation id 30 (state.change.logger)
[2021-05-15 18:51:16,104] ERROR [Controller id=0 epoch=3] Controller 0 epoch 3 failed to change state for partition Sensor-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-2 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:431)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:553)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:551)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:920)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:428)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:339)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1335)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1297)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1297)
	at kafka.controller.KafkaController.process(KafkaController.scala:2392)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2021-05-15 18:51:16,105] ERROR [Controller id=0 epoch=3] Controller 0 epoch 3 failed to change state for partition Sensor-3 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-3 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:431)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:553)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:551)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:920)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:428)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:339)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1335)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1297)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1297)
	at kafka.controller.KafkaController.process(KafkaController.scala:2392)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2021-05-15 18:51:16,106] ERROR [Controller id=0 epoch=3] Controller 0 epoch 3 failed to change state for partition Sensor-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-1 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:431)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:553)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:551)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:920)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:428)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:339)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1335)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1297)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1297)
	at kafka.controller.KafkaController.process(KafkaController.scala:2392)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2021-05-15 18:51:16,107] INFO [Controller id=0 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2021-05-15 18:51:16,107] INFO [Controller id=0 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2021-05-15 18:51:21,835] INFO [Controller id=0 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2021-05-15 18:51:21,847] ERROR [Controller id=0 epoch=3] Controller 0 epoch 3 failed to change state for partition Sensors-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensors-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:431)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:553)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:551)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:920)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:428)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:339)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:618)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:588)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1604)
	at kafka.controller.KafkaController.process(KafkaController.scala:2400)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2021-05-15 18:51:21,848] ERROR [Controller id=0 epoch=3] Controller 0 epoch 3 failed to change state for partition Sensor-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:431)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:553)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:551)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:920)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:428)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:339)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:618)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:588)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1604)
	at kafka.controller.KafkaController.process(KafkaController.scala:2400)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2021-05-15 18:51:21,849] ERROR [Controller id=0 epoch=3] Controller 0 epoch 3 failed to change state for partition Sensor-5 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-5 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:431)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:553)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:551)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:920)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:428)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:339)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:618)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:588)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1604)
	at kafka.controller.KafkaController.process(KafkaController.scala:2400)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2021-05-15 18:51:21,850] ERROR [Controller id=0 epoch=3] Controller 0 epoch 3 failed to change state for partition Sensor-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:431)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:553)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:551)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:920)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:428)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:339)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:618)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:588)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1604)
	at kafka.controller.KafkaController.process(KafkaController.scala:2400)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2021-05-15 18:51:21,850] ERROR [Controller id=0 epoch=3] Controller 0 epoch 3 failed to change state for partition Sensor-3 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-3 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:431)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:553)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:551)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:920)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:428)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:339)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:618)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:588)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1604)
	at kafka.controller.KafkaController.process(KafkaController.scala:2400)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2021-05-15 18:51:21,850] ERROR [Controller id=0 epoch=3] Controller 0 epoch 3 failed to change state for partition Sensor-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:431)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:553)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:551)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:920)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:428)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:339)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:618)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:588)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1604)
	at kafka.controller.KafkaController.process(KafkaController.scala:2400)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2021-05-15 18:51:21,851] ERROR [Controller id=0 epoch=3] Controller 0 epoch 3 failed to change state for partition Sensor-4 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-4 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:431)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:553)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:551)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:920)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:428)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:339)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:618)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:588)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1604)
	at kafka.controller.KafkaController.process(KafkaController.scala:2400)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2021-05-15 18:51:21,851] INFO [Controller id=0 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2021-05-15 18:51:21,865] INFO [Controller id=0 epoch=3] Partition Sensor-1 state changed to (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:3) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2021-05-15 18:51:21,866] INFO [Controller id=0 epoch=3] Partition Sensor-5 state changed to (Leader:-1,ISR:4,LeaderEpoch:3,ControllerEpoch:3) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2021-05-15 18:51:21,866] INFO [Controller id=0 epoch=3] Partition Sensor-0 state changed to (Leader:-1,ISR:4,LeaderEpoch:3,ControllerEpoch:3) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2021-05-15 18:51:21,866] INFO [Controller id=0 epoch=3] Sending LeaderAndIsr request to broker 3 with 1 become-leader and 0 become-follower partitions (state.change.logger)
[2021-05-15 18:51:21,867] INFO [Controller id=0 epoch=3] Sending UpdateMetadata request to brokers HashSet(0, 3) for 3 partitions (state.change.logger)
[2021-05-15 18:51:22,035] INFO [Controller id=0 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2021-05-15 18:51:22,041] ERROR [Controller id=0 epoch=3] Controller 0 epoch 3 failed to change state for partition Sensors-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensors-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:431)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:553)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:551)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:920)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:428)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:339)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:618)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:588)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1604)
	at kafka.controller.KafkaController.process(KafkaController.scala:2400)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2021-05-15 18:51:22,042] ERROR [Controller id=0 epoch=3] Controller 0 epoch 3 failed to change state for partition Sensor-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:431)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:553)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:551)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:920)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:428)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:339)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:618)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:588)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1604)
	at kafka.controller.KafkaController.process(KafkaController.scala:2400)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2021-05-15 18:51:22,043] ERROR [Controller id=0 epoch=3] Controller 0 epoch 3 failed to change state for partition Sensor-5 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-5 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:431)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:553)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:551)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:920)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:428)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:339)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:618)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:588)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1604)
	at kafka.controller.KafkaController.process(KafkaController.scala:2400)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2021-05-15 18:51:22,046] ERROR [Controller id=0 epoch=3] Controller 0 epoch 3 failed to change state for partition Sensor-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:431)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:553)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:551)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:920)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:428)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:339)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:618)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:588)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1604)
	at kafka.controller.KafkaController.process(KafkaController.scala:2400)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2021-05-15 18:51:22,047] ERROR [Controller id=0 epoch=3] Controller 0 epoch 3 failed to change state for partition Sensor-3 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-3 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:431)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:553)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:551)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:920)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:428)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:339)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:618)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:588)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1604)
	at kafka.controller.KafkaController.process(KafkaController.scala:2400)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2021-05-15 18:51:22,048] ERROR [Controller id=0 epoch=3] Controller 0 epoch 3 failed to change state for partition Sensor-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:431)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:553)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:551)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:920)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:428)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:339)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:618)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:588)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1604)
	at kafka.controller.KafkaController.process(KafkaController.scala:2400)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2021-05-15 18:51:22,048] ERROR [Controller id=0 epoch=3] Controller 0 epoch 3 failed to change state for partition Sensor-4 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-4 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:431)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:553)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:551)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:920)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:428)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:339)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:618)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:588)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1604)
	at kafka.controller.KafkaController.process(KafkaController.scala:2400)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2021-05-15 18:51:22,049] INFO [Controller id=0 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2021-05-15 18:51:22,056] INFO [Controller id=0 epoch=3] Partition Sensor-2 state changed to (Leader:-1,ISR:3,LeaderEpoch:3,ControllerEpoch:3) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2021-05-15 18:51:22,057] INFO [Controller id=0 epoch=3] Partition Sensor-3 state changed to (Leader:-1,ISR:3,LeaderEpoch:3,ControllerEpoch:3) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2021-05-15 18:51:22,057] INFO [Controller id=0 epoch=3] Partition Sensor-1 state changed to (Leader:-1,ISR:3,LeaderEpoch:3,ControllerEpoch:3) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2021-05-15 18:51:22,058] INFO [Controller id=0 epoch=3] Sending LeaderAndIsr request to broker 0 with 0 become-leader and 2 become-follower partitions (state.change.logger)
[2021-05-15 18:51:22,058] INFO [Controller id=0 epoch=3] Sending UpdateMetadata request to brokers HashSet(0) for 3 partitions (state.change.logger)
